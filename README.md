[Unfortunately I have lost the final code. This code is incomplete and may contain some bugs. You need to implement the operational hours based filtering part. The current version is wrong, so I implemented it differently in the final part.]

This is the code for the SEAGET model.
